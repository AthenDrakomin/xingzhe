import{u as j,a as p,j as e}from"./index-C51D2hFb.js";import{r as f}from"./vendor-KfUPlHYY.js";import{u as N}from"./usePages-CTDqJ49q.js";import{p as b}from"./api-leedPX1m.js";import{P as n}from"./permissions-DiR0R8A_.js";const C=()=>{const{pages:l,isLoading:c,isError:x,mutate:m}=N(),{user:a}=j(),[r,i]=f.useState(null),s=p(),o=n.canCreatePage(a),d=n.canDeletePage(a),h=async t=>{if(window.confirm("确定要删除这个页面吗？")){if(!d){alert("您没有权限删除页面");return}try{i(t),await b.delete(t),m()}catch(u){console.error("删除失败:",u),alert("删除失败，请稍后重试")}finally{i(null)}}};return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-400",children:"加载中..."})}):x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-red-400",children:"加载失败，请稍后重试"})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl font-medium text-slate-100",children:"页面管理"}),o&&e.jsx("button",{onClick:()=>s("/cms/pages/new"),className:"bg-emerald-700 hover:bg-emerald-600 text-white px-4 py-2 rounded-sm text-sm transition-colors",children:"新建页面"})]}),l.length===0?e.jsxs("div",{className:"bg-slate-900/30 border border-white/10 rounded-sm p-12 text-center",children:[e.jsx("p",{className:"text-slate-500",children:"暂无页面"}),e.jsx("button",{onClick:()=>s("/cms/pages/new"),className:"mt-4 text-emerald-400 hover:text-emerald-300 text-sm",children:"创建第一个页面"})]}):e.jsx("div",{className:"bg-slate-900/30 border border-white/10 rounded-sm overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b border-white/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-4 px-6 text-slate-400 font-medium text-sm",children:"标题"}),e.jsx("th",{className:"text-left py-4 px-6 text-slate-400 font-medium text-sm",children:"路径"}),e.jsx("th",{className:"text-left py-4 px-6 text-slate-400 font-medium text-sm",children:"状态"}),e.jsx("th",{className:"text-left py-4 px-6 text-slate-400 font-medium text-sm",children:"排序"}),e.jsx("th",{className:"text-right py-4 px-6 text-slate-400 font-medium text-sm",children:"操作"})]})}),e.jsx("tbody",{children:l.map(t=>e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5",children:[e.jsxs("td",{className:"py-4 px-6 text-slate-300",children:[e.jsx("div",{className:"font-medium",children:t.title}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:t.slug})]}),e.jsxs("td",{className:"py-4 px-6 text-slate-400",children:["/",t.slug]}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-sm ${t.status==="published"?"bg-emerald-900/30 text-emerald-400":"bg-yellow-900/30 text-yellow-400"}`,children:t.status==="published"?"已发布":"草稿"})}),e.jsx("td",{className:"py-4 px-6 text-slate-400",children:t.order}),e.jsx("td",{className:"py-4 px-6 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(`/cms/pages/edit/${t.id}`),className:"text-slate-400 hover:text-white text-sm",children:"编辑"}),d&&e.jsx("button",{onClick:()=>h(t.id),disabled:r===t.id,className:"text-red-400 hover:text-red-300 text-sm disabled:opacity-50",children:r===t.id?"删除中...":"删除"})]})})]},t.id))})]})})]})};export{C as default};
